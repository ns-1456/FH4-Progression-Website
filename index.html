<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Gentleman's Tour | FH4 Companion</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/js/all.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;800&family=Orbitron:wght@500;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-color: #0f0f13;
            --card-bg: #1a1a20;
            --sidebar-bg: #15151a;
            --text-main: #f0f0f0;
            --text-muted: #888899;
            --accent-red: #e74c3c;
            --accent-green: #2ecc71;
            --accent-gold: #f1c40f;
            --accent-purple: #9b59b6;
            --accent-teal: #1abc9c;
            --ai-blue: #3498db;
            --border-radius: 12px;
            --shadow: 0 8px 30px rgba(0,0,0,0.5);
        }

        body {
            font-family: 'Montserrat', sans-serif;
            background-color: var(--bg-color);
            color: var(--text-main);
            margin: 0;
            padding: 0;
            display: flex;
            min-height: 100vh;
        }

        /* --- Sidebar Navigation --- */
        .sidebar {
            width: 250px;
            background-color: var(--sidebar-bg);
            padding: 30px 20px;
            position: fixed;
            height: 100vh;
            border-right: 1px solid #333;
            overflow-y: auto;
            z-index: 100;
        }

        .logo-area {
            text-align: center;
            margin-bottom: 40px;
        }

        .logo-title {
            font-family: 'Orbitron', sans-serif;
            font-size: 1.5rem;
            color: var(--text-main);
            letter-spacing: 2px;
            margin: 0;
            text-transform: uppercase;
        }

        .logo-subtitle {
            font-size: 0.75rem;
            color: var(--accent-gold);
            text-transform: uppercase;
            letter-spacing: 3px;
            margin-top: 5px;
        }

        .nav-links {
            list-style: none;
            padding: 0;
        }

        .nav-item {
            margin-bottom: 10px;
        }

        .nav-btn {
            display: flex;
            align-items: center;
            width: 100%;
            background: transparent;
            border: none;
            color: var(--text-muted);
            padding: 12px 15px;
            border-radius: 8px;
            cursor: pointer;
            text-align: left;
            font-family: 'Montserrat', sans-serif;
            font-weight: 600;
            transition: all 0.2s;
            text-decoration: none;
        }

        .nav-btn:hover {
            background-color: rgba(255,255,255,0.05);
            color: var(--text-main);
        }

        .nav-btn.active {
            background-color: var(--accent-red);
            color: white;
            box-shadow: 0 4px 15px rgba(231, 76, 60, 0.3);
        }
        
        .nav-btn.completed {
            color: var(--accent-green);
        }
        
        .nav-btn i {
            width: 25px;
        }

        /* --- Main Content --- */
        .main-content {
            margin-left: 250px;
            flex-grow: 1;
            padding: 40px 60px;
        }

        /* --- Progress Header --- */
        .top-stats {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 40px;
            background: var(--card-bg);
            padding: 20px;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            border: 1px solid #333;
        }

        .stat-box {
            text-align: center;
        }
        
        .stat-label {
            font-size: 0.7rem;
            text-transform: uppercase;
            color: var(--text-muted);
            letter-spacing: 1px;
        }
        
        .stat-value {
            font-family: 'Orbitron', sans-serif;
            font-size: 1.5rem;
            color: var(--accent-gold);
        }

        .progress-bar-bg {
            flex-grow: 1;
            height: 12px;
            background: #333;
            border-radius: 6px;
            margin: 0 30px;
            overflow: hidden;
            position: relative;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--accent-red), var(--accent-gold));
            width: 0%;
            transition: width 0.5s ease;
            box-shadow: 0 0 10px rgba(231, 76, 60, 0.5);
        }

        /* --- Cards & Eras --- */
        .era-section {
            display: none; /* Hidden by default, JS toggles this */
            animation: fadeIn 0.4s ease;
        }
        
        .era-section.active-view {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .era-header-banner {
            background: linear-gradient(rgba(0,0,0,0.7), rgba(0,0,0,0.7)), #1a1a20;
            background-size: cover;
            background-position: center;
            padding: 60px;
            border-radius: var(--border-radius);
            margin-bottom: 30px;
            border-left: 6px solid var(--accent-red);
            box-shadow: var(--shadow);
            position: relative;
            overflow: hidden;
        }
        
        .era-header-banner::after {
            content: "";
            position: absolute;
            top: 0; right: 0; bottom: 0; left: 0;
            background: linear-gradient(to right, #1a1a20 20%, transparent 100%);
            z-index: 1;
        }

        .era-banner-content {
            position: relative;
            z-index: 2;
        }

        .era-years {
            font-family: 'Orbitron', sans-serif;
            color: var(--accent-red);
            font-size: 1rem;
            margin-bottom: 5px;
        }

        .era-title {
            font-size: 3rem;
            font-weight: 800;
            margin: 0;
            text-transform: uppercase;
            line-height: 1;
        }
        
        .era-status {
            display: inline-block;
            background: rgba(255,255,255,0.1);
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            margin-top: 15px;
            color: #aaa;
        }
        
        .era-status.locked { color: #e74c3c; border: 1px solid #e74c3c; }
        .era-status.unlocked { color: #2ecc71; border: 1px solid #2ecc71; }

        .content-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 25px;
        }

        .task-card {
            background: var(--card-bg);
            border-radius: var(--border-radius);
            padding: 25px;
            border: 1px solid #333;
            transition: transform 0.2s;
        }

        .task-card:hover {
            transform: translateY(-2px);
            border-color: #555;
        }

        .card-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid #333;
        }

        .card-title {
            font-family: 'Orbitron', sans-serif;
            font-size: 1.1rem;
            margin: 0;
        }
        
        /* Category Colors */
        .cat-garage .card-title { color: #ccc; }
        .cat-milestone .card-title { color: var(--accent-gold); }
        .cat-challenge .card-title { color: var(--accent-red); }
        .cat-scrapbook .card-title { color: var(--accent-teal); }
        .cat-legend .card-title { color: var(--accent-purple); }

        .task-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .task-item {
            display: flex;
            align-items: flex-start;
            margin-bottom: 15px;
            padding: 10px;
            border-radius: 8px;
            transition: background 0.2s;
        }

        .task-item:hover {
            background: rgba(255,255,255,0.03);
        }

        .custom-checkbox {
            width: 20px;
            height: 20px;
            border: 2px solid #555;
            border-radius: 4px;
            margin-right: 15px;
            margin-top: 3px;
            cursor: pointer;
            position: relative;
            flex-shrink: 0;
            appearance: none;
            background: transparent;
            transition: all 0.2s;
        }
        
        /* Checkbox coloring based on section */
        .cat-milestone .custom-checkbox { border-color: var(--accent-gold); }
        .cat-milestone .custom-checkbox:checked { background: var(--accent-gold); }
        
        .cat-challenge .custom-checkbox { border-color: var(--accent-red); }
        .cat-challenge .custom-checkbox:checked { background: var(--accent-red); }
        
        .cat-scrapbook .custom-checkbox { border-color: var(--accent-teal); }
        .cat-scrapbook .custom-checkbox:checked { background: var(--accent-teal); }
        
        .cat-legend .custom-checkbox { border-color: var(--accent-purple); }
        .cat-legend .custom-checkbox:checked { background: var(--accent-purple); }

        .custom-checkbox:checked::after {
            content: 'âœ“';
            color: #000;
            position: absolute;
            font-size: 14px;
            top: -2px;
            left: 2px;
            font-weight: bold;
        }

        .task-content {
            flex-grow: 1;
        }

        .task-title {
            font-weight: 600;
            font-size: 0.95rem;
            display: block;
            margin-bottom: 3px;
        }

        .task-desc {
            font-size: 0.8rem;
            color: var(--text-muted);
            line-height: 1.4;
        }
        
        .price-tag {
            background: #333;
            color: var(--accent-gold);
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 0.7rem;
            margin-left: 8px;
            font-weight: 600;
        }

        /* --- Footer Actions --- */
        .action-area {
            margin-top: 40px;
            text-align: center;
        }

        .unlock-btn {
            background: var(--accent-red);
            color: white;
            border: none;
            padding: 15px 40px;
            font-family: 'Orbitron', sans-serif;
            font-size: 1rem;
            border-radius: 30px;
            cursor: pointer;
            transition: all 0.3s;
            text-transform: uppercase;
            letter-spacing: 1px;
            box-shadow: 0 4px 15px rgba(231, 76, 60, 0.4);
        }

        .unlock-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(231, 76, 60, 0.6);
        }

        .unlock-btn:disabled {
            background: #333;
            color: #666;
            cursor: not-allowed;
            box-shadow: none;
        }

        /* --- AI Engineering --- */
        .ai-panel {
            background: #151922;
            border: 1px solid var(--ai-blue);
            border-radius: var(--border-radius);
            padding: 25px;
            margin-top: 50px;
            position: relative;
        }
        
        .ai-badge {
            position: absolute;
            top: -12px;
            left: 25px;
            background: var(--ai-blue);
            color: white;
            padding: 2px 12px;
            font-size: 0.7rem;
            border-radius: 12px;
            font-weight: 800;
            text-transform: uppercase;
        }

        .ai-input {
            width: 100%;
            background: #0f0f13;
            border: 1px solid #333;
            color: white;
            padding: 12px;
            border-radius: 6px;
            margin-bottom: 10px;
            font-family: 'Montserrat', sans-serif;
        }
        
        .ai-input:focus {
            outline: none;
            border-color: var(--ai-blue);
        }

        .ai-btn {
            background: var(--ai-blue);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
        }

        .ai-response {
            margin-top: 15px;
            padding: 15px;
            background: rgba(52, 152, 219, 0.1);
            border-radius: 6px;
            color: #d1e8ff;
            font-style: italic;
            display: none;
        }

        .reset-link {
            display: block;
            text-align: center;
            margin-top: 40px;
            color: #555;
            text-decoration: none;
            font-size: 0.8rem;
        }
        .reset-link:hover { color: var(--accent-red); }

        /* Responsive */
        @media(max-width: 900px) {
            .sidebar { width: 70px; padding: 20px 10px; }
            .logo-title, .logo-subtitle, .nav-text { display: none; }
            .main-content { margin-left: 70px; padding: 20px; }
            .nav-btn { justify-content: center; }
            .nav-btn i { margin: 0; }
        }
    </style>
</head>
<body>

<!-- SIDEBAR NAVIGATION -->
<nav class="sidebar">
    <div class="logo-area">
        <h1 class="logo-title">GENTLEMAN</h1>
        <div class="logo-subtitle">TOUR</div>
    </div>
    
    <ul class="nav-links">
        <li class="nav-item">
            <button class="nav-btn active" onclick="switchView(1)" id="nav-1">
                <i class="fas fa-chess-pawn"></i> <span class="nav-text" style="margin-left: 10px;">The 1950s</span>
            </button>
        </li>
        <li class="nav-item">
            <button class="nav-btn" onclick="switchView(2)" id="nav-2">
                <i class="fas fa-chess-knight"></i> <span class="nav-text" style="margin-left: 10px;">The 1960s</span>
            </button>
        </li>
        <li class="nav-item">
            <button class="nav-btn" onclick="switchView(3)" id="nav-3">
                <i class="fas fa-chess-bishop"></i> <span class="nav-text" style="margin-left: 10px;">The 1970s</span>
            </button>
        </li>
        <li class="nav-item">
            <button class="nav-btn" onclick="switchView(4)" id="nav-4">
                <i class="fas fa-chess-rook"></i> <span class="nav-text" style="margin-left: 10px;">The 80s/90s</span>
            </button>
        </li>
        <li class="nav-item">
            <button class="nav-btn" onclick="switchView(5)" id="nav-5">
                <i class="fas fa-microchip"></i> <span class="nav-text" style="margin-left: 10px;">The 2000s</span>
            </button>
        </li>
        <li class="nav-item">
            <button class="nav-btn" onclick="switchView(6)" id="nav-6">
                <i class="fas fa-chess-king"></i> <span class="nav-text" style="margin-left: 10px;">Hypercars</span>
            </button>
        </li>
    </ul>

    <div style="margin-top: auto; padding-top: 30px; border-top: 1px solid #333; text-align: center;">
        <i class="fas fa-flag-checkered" style="color: #333; font-size: 2rem;"></i>
    </div>
</nav>

<!-- MAIN CONTENT -->
<main class="main-content">

    <!-- Top Stats -->
    <div class="top-stats">
        <div class="stat-box">
            <div class="stat-value" id="total-progress">0%</div>
            <div class="stat-label">Completion</div>
        </div>
        <div class="progress-bar-bg">
            <div class="progress-fill" id="progress-fill"></div>
        </div>
        <div class="stat-box">
            <div class="stat-value" id="current-era-display">I</div>
            <div class="stat-label">Current Era</div>
        </div>
    </div>

    <!-- ERA 1 CONTENT -->
    <div class="era-section active-view" id="view-1">
        <div class="era-header-banner">
            <div class="era-banner-content">
                <div class="era-years">1950 - 1959</div>
                <h2 class="era-title">The Foundation</h2>
                <div class="era-status unlocked">Status: Active</div>
            </div>
        </div>

        <div class="content-grid">
            <!-- Garage -->
            <div class="task-card cat-garage">
                <div class="card-header"><i class="fas fa-car"></i> <h3 class="card-title">Garage</h3></div>
                <ul class="task-list">
                    <li class="task-item">
                        <input type="checkbox" class="custom-checkbox task-checkbox" onchange="updateProgress()">
                        <div class="task-content">
                            <span class="task-title">1970 Porsche 914/6 <span class="price-tag">25k</span></span>
                            <span class="task-desc">Starter Car. Keep it simple.</span>
                        </div>
                    </li>
                    <li class="task-item">
                        <input type="checkbox" class="custom-checkbox task-checkbox" onchange="updateProgress()">
                        <div class="task-content">
                            <span class="task-title">1959 Jaguar Mk II 3.8 <span class="price-tag">48k</span></span>
                            <span class="task-desc">Road Racing Saloon.</span>
                        </div>
                    </li>
                    <li class="task-item">
                        <input type="checkbox" class="custom-checkbox task-checkbox" onchange="updateProgress()">
                        <div class="task-content">
                            <span class="task-title">Jaguar Mk II (Rally) <span class="price-tag">Build</span></span>
                            <span class="task-desc">Off-road build.</span>
                        </div>
                    </li>
                </ul>
            </div>

            <!-- Milestones -->
            <div class="task-card cat-milestone">
                <div class="card-header"><i class="fas fa-trophy"></i> <h3 class="card-title">Milestones</h3></div>
                <ul class="task-list">
                    <li class="task-item">
                        <input type="checkbox" class="custom-checkbox task-checkbox objective" onchange="updateProgress()">
                        <div class="task-content">
                            <span class="task-title">Road Racing Level 5</span>
                            <span class="task-desc">Using only 50s cars.</span>
                        </div>
                    </li>
                    <li class="task-item">
                        <input type="checkbox" class="custom-checkbox task-checkbox objective" onchange="updateProgress()">
                        <div class="task-content">
                            <span class="task-title">Dirt Racing Level 5</span>
                            <span class="task-desc">Slide the heavy Jaguar.</span>
                        </div>
                    </li>
                    <li class="task-item">
                        <input type="checkbox" class="custom-checkbox task-checkbox objective" onchange="updateProgress()">
                        <div class="task-content">
                            <span class="task-title">Bank 300,000 CR</span>
                            <span class="task-desc">Prepare for the 60s.</span>
                        </div>
                    </li>
                </ul>
            </div>

            <!-- Challenges -->
            <div class="task-card cat-challenge">
                <div class="card-header"><i class="fas fa-stopwatch"></i> <h3 class="card-title">Challenges</h3></div>
                <ul class="task-list">
                    <li class="task-item">
                        <input type="checkbox" class="custom-checkbox task-checkbox objective" onchange="updateProgress()">
                        <div class="task-content">
                            <span class="task-title">The Explorer</span>
                            <span class="task-desc">Find 3 Beauty Spots.</span>
                        </div>
                    </li>
                    <li class="task-item">
                        <input type="checkbox" class="custom-checkbox task-checkbox objective" onchange="updateProgress()">
                        <div class="task-content">
                            <span class="task-title">Sunday Driver</span>
                            <span class="task-desc">Clean Race (0 collisions).</span>
                        </div>
                    </li>
                </ul>
            </div>
            
            <!-- Scrapbook -->
            <div class="task-card cat-scrapbook">
                <div class="card-header"><i class="fas fa-camera"></i> <h3 class="card-title">Scrapbook</h3></div>
                <ul class="task-list">
                    <li class="task-item">
                        <input type="checkbox" class="custom-checkbox task-checkbox" onchange="updateProgress()">
                        <div class="task-content">
                            <span class="task-title">"The Village Doctor"</span>
                            <span class="task-desc">Jaguar outside Broadway cottage.</span>
                        </div>
                    </li>
                    <li class="task-item">
                        <input type="checkbox" class="custom-checkbox task-checkbox" onchange="updateProgress()">
                        <div class="task-content">
                            <span class="task-title">"The Hillclimber"</span>
                            <span class="task-desc">Porsche 914 at Needle Climb.</span>
                        </div>
                    </li>
                </ul>
            </div>

            <!-- Legends -->
            <div class="task-card cat-legend">
                <div class="card-header"><i class="fas fa-crown"></i> <h3 class="card-title">Legends</h3></div>
                <ul class="task-list">
                    <li class="task-item">
                        <input type="checkbox" class="custom-checkbox task-checkbox" onchange="updateProgress()">
                        <div class="task-content">
                            <span class="task-title">1956 Jaguar D-Type</span>
                            <span class="task-desc">The 10M CR Dream.</span>
                        </div>
                    </li>
                    <li class="task-item">
                        <input type="checkbox" class="custom-checkbox task-checkbox" onchange="updateProgress()">
                        <div class="task-content">
                            <span class="task-title">1957 Ferrari 250 TR</span>
                            <span class="task-desc">Pure history.</span>
                        </div>
                    </li>
                </ul>
            </div>
        </div>

        <div class="action-area">
            <button class="unlock-btn" id="btn-1" onclick="completeEra(1)" disabled>Complete Chapter I</button>
        </div>
    </div>

    <!-- ERA 2 CONTENT -->
    <div class="era-section" id="view-2">
        <div class="era-header-banner">
            <div class="era-banner-content">
                <div class="era-years">1960 - 1969</div>
                <h2 class="era-title">The Golden Age</h2>
                <div class="era-status locked" id="status-2">Status: Locked</div>
            </div>
        </div>
        
        <div class="content-grid">
            <!-- Garage -->
            <div class="task-card cat-garage">
                <div class="card-header"><i class="fas fa-car"></i> <h3 class="card-title">Garage</h3></div>
                <ul class="task-list">
                    <li class="task-item"><input type="checkbox" class="custom-checkbox task-checkbox" onchange="updateProgress()"><div class="task-content"><span class="task-title">Ferrari Dino 246 GT</span></div></li>
                    <li class="task-item"><input type="checkbox" class="custom-checkbox task-checkbox" onchange="updateProgress()"><div class="task-content"><span class="task-title">Aston Martin DB5</span></div></li>
                </ul>
            </div>
            <!-- Milestones -->
            <div class="task-card cat-milestone">
                <div class="card-header"><i class="fas fa-trophy"></i> <h3 class="card-title">Milestones</h3></div>
                <ul class="task-list">
                    <li class="task-item"><input type="checkbox" class="custom-checkbox task-checkbox objective" onchange="updateProgress()"><div class="task-content"><span class="task-title">Road Racing Level 8</span></div></li>
                    <li class="task-item"><input type="checkbox" class="custom-checkbox task-checkbox objective" onchange="updateProgress()"><div class="task-content"><span class="task-title">Dirt Racing Level 8</span></div></li>
                </ul>
            </div>
            <!-- Challenges -->
            <div class="task-card cat-challenge">
                <div class="card-header"><i class="fas fa-stopwatch"></i> <h3 class="card-title">Challenges</h3></div>
                <ul class="task-list">
                    <li class="task-item"><input type="checkbox" class="custom-checkbox task-checkbox objective" onchange="updateProgress()"><div class="task-content"><span class="task-title">Leap of Faith (2 Stars Danger Sign)</span></div></li>
                    <li class="task-item"><input type="checkbox" class="custom-checkbox task-checkbox objective" onchange="updateProgress()"><div class="task-content"><span class="task-title">Rain Master (Win in heavy rain)</span></div></li>
                </ul>
            </div>
            <!-- Scrapbook -->
            <div class="task-card cat-scrapbook">
                <div class="card-header"><i class="fas fa-camera"></i> <h3 class="card-title">Scrapbook</h3></div>
                <ul class="task-list">
                    <li class="task-item"><input type="checkbox" class="custom-checkbox task-checkbox" onchange="updateProgress()"><div class="task-content"><span class="task-title">"Her Majesty's Service"</span><span class="task-desc">DB5 at Edinburgh Castle.</span></div></li>
                    <li class="task-item"><input type="checkbox" class="custom-checkbox task-checkbox" onchange="updateProgress()"><div class="task-content"><span class="task-title">"Italian Holiday"</span><span class="task-desc">Dino at Viaduct.</span></div></li>
                </ul>
            </div>
        </div>

        <div class="action-area">
            <button class="unlock-btn" id="btn-2" onclick="completeEra(2)" disabled>Complete Chapter II</button>
        </div>
    </div>

    <!-- ERA 3 CONTENT (70s) -->
    <div class="era-section" id="view-3">
        <div class="era-header-banner">
            <div class="era-banner-content">
                <div class="era-years">1970 - 1979</div>
                <h2 class="era-title">The Wedge Era</h2>
                <div class="era-status locked" id="status-3">Status: Locked</div>
            </div>
        </div>
        <div class="content-grid">
            <div class="task-card cat-milestone">
                <div class="card-header"><i class="fas fa-trophy"></i> <h3 class="card-title">Mandatory</h3></div>
                <ul class="task-list">
                    <li class="task-item"><input type="checkbox" class="custom-checkbox task-checkbox objective" onchange="updateProgress()"><div class="task-content"><span class="task-title">Reach Road Racing Lvl 10</span></div></li>
                    <li class="task-item"><input type="checkbox" class="custom-checkbox task-checkbox objective" onchange="updateProgress()"><div class="task-content"><span class="task-title">WIN The Colossus</span></div></li>
                    <li class="task-item"><input type="checkbox" class="custom-checkbox task-checkbox objective" onchange="updateProgress()"><div class="task-content"><span class="task-title">Reach Dirt Lvl 10</span></div></li>
                </ul>
            </div>
            <div class="task-card cat-garage">
                <div class="card-header"><i class="fas fa-car"></i> <h3 class="card-title">Garage</h3></div>
                <ul class="task-list">
                    <li class="task-item"><input type="checkbox" class="custom-checkbox task-checkbox" onchange="updateProgress()"><div class="task-content"><span class="task-title">Porsche 911 RS '73 (Safari)</span></div></li>
                    <li class="task-item"><input type="checkbox" class="custom-checkbox task-checkbox" onchange="updateProgress()"><div class="task-content"><span class="task-title">Ferrari Daytona</span></div></li>
                </ul>
            </div>
        </div>
        <div class="action-area">
            <button class="unlock-btn" id="btn-3" onclick="completeEra(3)" disabled>Complete Chapter III</button>
        </div>
    </div>

    <!-- ERA 4 CONTENT (80s/90s) -->
    <div class="era-section" id="view-4">
        <div class="era-header-banner">
            <div class="era-banner-content">
                <div class="era-years">1980 - 1999</div>
                <h2 class="era-title">Supercar Era</h2>
                <div class="era-status locked" id="status-4">Status: Locked</div>
            </div>
        </div>
        <div class="content-grid">
            <div class="task-card cat-milestone">
                <div class="card-header"><i class="fas fa-trophy"></i> <h3 class="card-title">Mandatory</h3></div>
                <ul class="task-list">
                    <li class="task-item"><input type="checkbox" class="custom-checkbox task-checkbox objective" onchange="updateProgress()"><div class="task-content"><span class="task-title">WIN The Gauntlet (Dirt)</span></div></li>
                    <li class="task-item"><input type="checkbox" class="custom-checkbox task-checkbox objective" onchange="updateProgress()"><div class="task-content"><span class="task-title">Unlock The Marathon (Street)</span></div></li>
                    <li class="task-item"><input type="checkbox" class="custom-checkbox task-checkbox objective" onchange="updateProgress()"><div class="task-content"><span class="task-title">WIN The Marathon</span></div></li>
                </ul>
            </div>
            <div class="task-card cat-garage">
                <div class="card-header"><i class="fas fa-car"></i> <h3 class="card-title">Garage</h3></div>
                <ul class="task-list">
                    <li class="task-item"><input type="checkbox" class="custom-checkbox task-checkbox" onchange="updateProgress()"><div class="task-content"><span class="task-title">Ferrari F40</span></div></li>
                    <li class="task-item"><input type="checkbox" class="custom-checkbox task-checkbox" onchange="updateProgress()"><div class="task-content"><span class="task-title">Porsche 959</span></div></li>
                    <li class="task-item"><input type="checkbox" class="custom-checkbox task-checkbox" onchange="updateProgress()"><div class="task-content"><span class="task-title">McLaren F1</span></div></li>
                </ul>
            </div>
        </div>
        <div class="action-area">
            <button class="unlock-btn" id="btn-4" onclick="completeEra(4)" disabled>Complete Chapter IV</button>
        </div>
    </div>

    <!-- ERA 5 CONTENT (2000s) -->
    <div class="era-section" id="view-5">
        <div class="era-header-banner">
            <div class="era-banner-content">
                <div class="era-years">2000 - 2009</div>
                <h2 class="era-title">New Millennium</h2>
                <div class="era-status locked" id="status-5">Status: Locked</div>
            </div>
        </div>
        <div class="content-grid">
            <div class="task-card cat-milestone">
                <div class="card-header"><i class="fas fa-trophy"></i> <h3 class="card-title">Mandatory</h3></div>
                <ul class="task-list">
                    <li class="task-item"><input type="checkbox" class="custom-checkbox task-checkbox objective" onchange="updateProgress()"><div class="task-content"><span class="task-title">Win 10 Street Races (S1)</span></div></li>
                    <li class="task-item"><input type="checkbox" class="custom-checkbox task-checkbox objective" onchange="updateProgress()"><div class="task-content"><span class="task-title">Unlock The Titan (Cross Country)</span></div></li>
                    <li class="task-item"><input type="checkbox" class="custom-checkbox task-checkbox objective" onchange="updateProgress()"><div class="task-content"><span class="task-title">WIN The Titan</span></div></li>
                </ul>
            </div>
            <div class="task-card cat-garage">
                <div class="card-header"><i class="fas fa-car"></i> <h3 class="card-title">Garage</h3></div>
                <ul class="task-list">
                    <li class="task-item"><input type="checkbox" class="custom-checkbox task-checkbox" onchange="updateProgress()"><div class="task-content"><span class="task-title">Porsche Carrera GT</span></div></li>
                    <li class="task-item"><input type="checkbox" class="custom-checkbox task-checkbox" onchange="updateProgress()"><div class="task-content"><span class="task-title">Ferrari Enzo</span></div></li>
                </ul>
            </div>
        </div>
        <div class="action-area">
            <button class="unlock-btn" id="btn-5" onclick="completeEra(5)" disabled>Complete Chapter V</button>
        </div>
    </div>

    <!-- ERA 6 CONTENT (Hypercars) -->
    <div class="era-section" id="view-6">
        <div class="era-header-banner">
            <div class="era-banner-content">
                <div class="era-years">2010 - Present</div>
                <h2 class="era-title">Hypercar Era</h2>
                <div class="era-status locked" id="status-6">Status: Locked</div>
            </div>
        </div>
        <div class="content-grid">
            <div class="task-card cat-milestone">
                <div class="card-header"><i class="fas fa-trophy"></i> <h3 class="card-title">Mandatory</h3></div>
                <ul class="task-list">
                    <li class="task-item"><input type="checkbox" class="custom-checkbox task-checkbox objective" onchange="updateProgress()"><div class="task-content"><span class="task-title">Road Racing Level 20</span></div></li>
                    <li class="task-item"><input type="checkbox" class="custom-checkbox task-checkbox objective" onchange="updateProgress()"><div class="task-content"><span class="task-title">WIN The Goliath</span></div></li>
                </ul>
            </div>
            <div class="task-card cat-garage">
                <div class="card-header"><i class="fas fa-car"></i> <h3 class="card-title">Garage</h3></div>
                <ul class="task-list">
                    <li class="task-item"><input type="checkbox" class="custom-checkbox task-checkbox" onchange="updateProgress()"><div class="task-content"><span class="task-title">McLaren P1</span></div></li>
                    <li class="task-item"><input type="checkbox" class="custom-checkbox task-checkbox" onchange="updateProgress()"><div class="task-content"><span class="task-title">Porsche 918 Spyder</span></div></li>
                    <li class="task-item"><input type="checkbox" class="custom-checkbox task-checkbox" onchange="updateProgress()"><div class="task-content"><span class="task-title">Ferrari LaFerrari</span></div></li>
                </ul>
            </div>
        </div>
        
        <div style="text-align: center; margin-top: 50px;">
            <h1 style="color: var(--accent-gold); font-family: 'Orbitron';">CAMPAIGN COMPLETE</h1>
        </div>
    </div>

    <!-- AI SECTION -->
    <div class="ai-panel">
        <div class="ai-badge">Scuderia AI</div>
        <h3>Chief Mechanic & Team Principal</h3>
        <p style="color: #666; font-size: 0.8rem; margin-bottom: 20px;">Powered by Gemini</p>
        
        <div style="display: flex; gap: 10px; margin-bottom: 10px;">
            <input type="text" id="car-input" class="ai-input" placeholder="Car Model (e.g. F40)">
            <input type="text" id="issue-input" class="ai-input" placeholder="Question (e.g. Understeer setup?)">
        </div>
        
        <button class="ai-btn" onclick="consultMechanic()">Ask Mechanic</button>
        <button class="ai-btn" style="background: #444;" onclick="generateReport()">Generate Journal Entry</button>
        
        <div class="ai-response" id="mechanic-response">
            <i class="fas fa-circle-notch fa-spin"></i> Processing...
        </div>
    </div>

    <a href="#" class="reset-link" onclick="resetProgress()">Reset Campaign Data</a>

</main>

<script>
    const apiKey = ""; // API Key injected here

    // State Variables
    let currentEra = 1;

    window.onload = function() {
        loadProgress();
        // Auto-switch to current active era
        const savedEra = parseInt(localStorage.getItem('fh4_gentleman_era')) || 1;
        switchView(savedEra);
    };

    function switchView(eraNum) {
        // Hide all views
        document.querySelectorAll('.era-section').forEach(el => el.classList.remove('active-view'));
        document.querySelectorAll('.nav-btn').forEach(el => el.classList.remove('active'));
        
        // Show selected view
        document.getElementById('view-' + eraNum).classList.add('active-view');
        document.getElementById('nav-' + eraNum).classList.add('active');
        
        // Update display logic if needed (e.g., enable/disable based on lock status)
    }

    function updateProgress() {
        const checkboxes = document.querySelectorAll('.task-checkbox');
        let checked = 0;
        let state = [];

        checkboxes.forEach((box, index) => {
            if (box.checked) checked++;
            state.push(box.checked);
        });

        // Save state
        localStorage.setItem('fh4_gentleman_progress', JSON.stringify(state));

        // Update Global Stats
        const percent = Math.round((checked / checkboxes.length) * 100);
        document.getElementById('total-progress').innerText = percent + '%';
        document.getElementById('progress-fill').style.width = percent + '%';

        checkObjectives();
    }

    function checkObjectives() {
        for(let i=1; i<=6; i++) {
            const container = document.getElementById('view-'+i);
            const objectives = container.querySelectorAll('.objective');
            let allMet = true;
            
            if(objectives.length === 0) continue;

            objectives.forEach(obj => { if(!obj.checked) allMet = false; });
            
            const btn = document.getElementById('btn-'+i);
            if(btn) {
                btn.disabled = !allMet;
                // Auto-complete era when all objectives are met (no confirmation needed)
                if(allMet && i === currentEra) {
                    // Check if we haven't already auto-completed this era
                    const alreadyCompleted = localStorage.getItem('fh4_gentleman_era_auto_' + i);
                    if(!alreadyCompleted) {
                        // Small delay to ensure UI updates, then auto-advance
                        setTimeout(() => {
                            localStorage.setItem('fh4_gentleman_era_auto_' + i, 'true');
                            completeEra(i);
                        }, 300);
                    }
                }
            }
        }
    }

    function completeEra(eraNum) {
        // Mark current era as completed
        localStorage.setItem('fh4_gentleman_era_completed_' + eraNum, 'true');
        
        // Unlock next era
        const nextEra = eraNum + 1;
        if(nextEra <= 6) {
            localStorage.setItem('fh4_gentleman_era', nextEra);
            currentEra = nextEra;
            loadProgress(); // Reloads UI state
            switchView(nextEra);
        }
    }

    function loadProgress() {
        // Load Checks
        const savedState = JSON.parse(localStorage.getItem('fh4_gentleman_progress'));
        if (savedState) {
            const checkboxes = document.querySelectorAll('.task-checkbox');
            checkboxes.forEach((box, index) => {
                box.checked = savedState[index];
            });
        }

        // Load Era Lock State
        const savedEra = parseInt(localStorage.getItem('fh4_gentleman_era')) || 1;
        currentEra = savedEra;
        document.getElementById('current-era-display').innerText = intToRoman(savedEra);

        for(let i=1; i<=6; i++) {
            const statusEl = document.getElementById('status-'+i);
            const navBtn = document.getElementById('nav-'+i);
            
            if (i < savedEra) {
                if(statusEl) { statusEl.innerText = "Completed"; statusEl.className = "era-status unlocked"; }
                if(navBtn) navBtn.classList.add('completed');
            } else if (i === savedEra) {
                if(statusEl) { statusEl.innerText = "Active"; statusEl.className = "era-status unlocked"; }
            } else {
                if(statusEl) { statusEl.innerText = "Locked"; statusEl.className = "era-status locked"; }
            }
        }
        
        updateProgress(); // Recalculate bar
    }

    function intToRoman(num) {
        const rom = ["", "I", "II", "III", "IV", "V", "VI"];
        return rom[num] || num;
    }

    function resetProgress() {
        if(confirm("Reset entire campaign?")) {
            localStorage.clear();
            location.reload();
        }
    }

    // --- AI Functions ---
    async function consultMechanic() {
        const car = document.getElementById('car-input').value;
        const issue = document.getElementById('issue-input').value;
        const respBox = document.getElementById('mechanic-response');
        
        if(!car || !issue) return alert("Enter car and question.");
        
        respBox.style.display = 'block';
        respBox.innerHTML = '<i class="fas fa-circle-notch fa-spin"></i> Tuning engine...';
        
        const prompt = `Roleplay as a Forza Horizon 4 Chief Mechanic. User Car: ${car}. Issue: ${issue}. Give specific tuning advice (springs, dampers, diff).`;
        const reply = await callGemini(prompt);
        respBox.innerText = reply;
    }

    async function generateReport() {
        const respBox = document.getElementById('mechanic-response');
        respBox.style.display = 'block';
        respBox.innerHTML = '<i class="fas fa-circle-notch fa-spin"></i> Writing journal...';
        
        const prompt = "Write a short, immersive journal entry for a racing team principal in Forza Horizon 4 based on progress.";
        const reply = await callGemini(prompt);
        respBox.innerText = reply;
    }

    async function callGemini(userPrompt) {
        const url = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`;
        const payload = { contents: [{ parts: [{ text: userPrompt }] }] };
        
        try {
            const res = await fetch(url, { method: 'POST', headers: {'Content-Type': 'application/json'}, body: JSON.stringify(payload)});
            const data = await res.json();
            return data.candidates?.[0]?.content?.parts?.[0]?.text || "Radio silence...";
        } catch(e) { return "Connection Error"; }
    }
</script>

</body>
</html>